{% extends "base.html" %}
{% block title %}
    Manager Project
{% endblock title %}
{% block style %}
<link rel="stylesheet" href="{{ MEDIA_URL }}css/sales/managerpro.css">
{% endblock style %}
{% block script %}
<script src="{{ MEDIA_URL }}js/mustache.js"></script>
<script src="{{ MEDIA_URL }}js/sales/managerpro.js"></script>
<script>
equalheight = function(container){
    var currentTallest = 0,
    currentRowStart = 0,
    rowDivs = new Array(),
    $el,
    topPosition = 0;
    $(container).each(function() {
        $el = $(this);
        $($el).height('auto')
        topPostion = $el.position().top;

        if (currentRowStart != topPostion) {
            for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
            rowDivs[currentDiv].height(currentTallest);
        }
        rowDivs.length = 0; // empty the array
        currentRowStart = topPostion;
        currentTallest = $el.height();
            rowDivs.push($el);
        } else {
            rowDivs.push($el);
            currentTallest = (currentTallest < $el.height()) ? ($el.height()) : (currentTallest);
        }
        for (currentDiv = 0 ; currentDiv < rowDivs.length ; currentDiv++) {
            rowDivs[currentDiv].height(currentTallest);
        }
    });
}
$(window).load(function() {
    equalheight('.all-sectors article');
});
$(window).resize(function(){
    equalheight('.all-sectors article');
});
</script>
{% endblock script %}
{% block menu %}
    {% include "menus/sale.htm" %}
{% endblock menu %}
{% block content %}
<div class="container">
    <div class="well">
        <h3>
            Administrador de Proyecto
            <br>
            <a href="{% url 'view_projects' %}" class="btn btn-default btn-xs">
                <span class="glyphicon glyphicon-chevron-left"></span> Regresar
            </a>
        </h3>
        <div class="row">
            <div class="col-md-3">
                <div class="panel panel-primary panel-manager">
                    <div class="panel-body">
                        <h4>Sectores y Subproyectos</h4>
                        <hr>
                        <div class="panel-group" id="accordion">
                            <div class="panel panel-primary sector-default">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#accordion" href="#default">
                                          Proyecto Default
                                        </a>
                                    </h4>
                                </div>
                                <div id="default" class="panel-collapse collapse in">
                                  <div class="panel-body">
                                    <ul class="sectors sectorsdefault">
                                        {% for x in sectors %}
                                            {% ifequal x.subproyecto_id None %}
                                                <li>
                                                    <a href="" class="text-black">
                                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                                        {{ x.nomsec }}
                                                    </a>
                                                </li>
                                            {% endifequal %}
                                        {% endfor %}
                                    </ul>
                                  </div>
                                </div>
                            </div>
                            {% for x in subpro %}
                                <div class="panel panel-primary" data-sub="{{ x.subproyecto_id }}">
                                    <div class="panel-heading">
                                      <h5 class="panel-title">
                                        <a class="text-{{ x.subproyecto_id }}" data-toggle="collapse" data-parent="#accordion" href="#{{ x.subproyecto_id }}">
                                            {{ x.nomsub }}
                                        </a>
                                      </h5>
                                    </div>
                                    <div id="{{ x.subproyecto_id }}" class="panel-collapse collapse">
                                        <div class="panel-footer">
                                            <div class="btn-group btn-group-justified">
                                                <div class="btn-group">
                                                    <button class="btn btn-xs btn-default text-black btn-edit-sub" value="{{ x.subproyecto_id }}"><span class="glyphicon glyphicon-pencil"></span></button>
                                                </div>
                                                <div class="btn-group">
                                                    <button class="btn btn-xs btn-default text-black btn-del-sub" value="{{ x.subproyecto_id }}"><span class="glyphicon glyphicon-trash"></span></button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel-body">
                                            <ul class="sectors sectors{{ x.subproyecto_id }}">
                                                {% for j in sectors %}
                                                    {% ifequal x.subproyecto_id j.subproyecto_id  %}
                                                        <li><a href="" class="text-black"><span class="glyphicon glyphicon-chevron-right"></span> {{ j.nomsec }}</a></li>
                                                    {% endifequal %}
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-9">
                <div class="panel panel-primary panel-manager">
                    <div class="panel-body">
                        <input type="hidden" name="pro" value="{{ project.proyecto_id }}">
                        <input type="hidden" name="sub" value="">
                        <div class="header-project">
                            <p>
                                <strong>Proyecto :</strong> {{ project.nompro }}
                                <strong> Codigo :</strong> {{ project.proyecto_id}}
                            </p>
                            <p>
                                <strong>Direcci√≥n: </strong> {{ project.direccion }}
                            </p>
                        </div>
                        <div class="btn-group btn-group-justified">
                            <div class="btn-group">
                                <button class="btn btn-primary btn-xs new-sector">
                                    <span class="glyphicon glyphicon-th"></span>
                                    <span class="visible-lg visible-md">Nuevo Sector</span>
                                </button>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary btn-xs new-subproject">
                                    <span class="glyphicon glyphicon-th-large"></span>
                                    <span class="visible-lg visible-md">Nuevo Subproyeto</span>
                                </button>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary btn-xs">
                                    <span class="glyphicon glyphicon-user"></span>
                                    <span class="visible-lg visible-sm">Responsable</span>
                                </button>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary btn-xs">
                                    <span class="glyphicon glyphicon-compressed"></span>
                                    <span class="visible-lg visible-sm">Archivos</span>
                                </button>
                            </div>
                            <div class="btn-group">
                                <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown">
                                    <span class="caret"></span>
                                    <span class="visible-lg visible-md">Vista</span>
                                </button>
                                <ul class="dropdown-menu" role="menu">
                                  <li><a href="#"><span class="glyphicon glyphicon-th"></span> Cuadros</a></li>
                                  <li><a href="#"><span class="glyphicon glyphicon-align-justify"></span> Lista</a></li>
                                </ul>
                            </div>
                        </div>
                        <hr>
                        <div class="all-sectors">
                            {% for x in sectors %}
                                {% ifequal x.subproyecto_id None  %}
                                    <article>
                                        <button class="btn btn-xs text-black btn-link pull-left btn-edit-sector" value="{{ x.sector_id }}">
                                            <span class="glyphicon glyphicon-pencil"></span>
                                        </button>
                                        <button class="btn btn-xs text-black btn-link pull-right" value="{{ x.sector_id }}">
                                            <span class="glyphicon glyphicon-trash"></span>
                                        </button>
                                        <a href="" class="text-black">
                                            {{ x.sector_id }}
                                            {{ x.nomsec }}
                                            <small>{{ x.planoid }}</small>
                                        </a>
                                    </article>
                                {% endifequal %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}